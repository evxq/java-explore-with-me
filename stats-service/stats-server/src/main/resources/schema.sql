DROP TABLE IF EXISTS hits CASCADE;
DROP TABLE IF EXISTS views CASCADE;

CREATE TABLE IF NOT EXISTS stats (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    app VARCHAR(128) NOT NULL,
    uri VARCHAR(128) NOT NULL,
    hits BIGINT NOT NULL,
    CONSTRAINT pk_stats PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS hits (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    app VARCHAR(128) NOT NULL,
    uri VARCHAR(128) NOT NULL,
    ip VARCHAR(128) NOT NULL,
    datetime TIMESTAMP NOT NULL,
    stats_id BIGINT NOT NULL,
    CONSTRAINT pk_hits PRIMARY KEY (id),
    CONSTRAINT fk_hits_stats FOREIGN KEY (stats_id) REFERENCES stats (id)
);